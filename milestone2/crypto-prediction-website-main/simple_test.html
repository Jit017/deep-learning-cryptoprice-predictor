<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Prediction Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f0f0f0; }
        .container { max-width: 600px; margin: 0 auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .form-group { margin: 20px 0; }
        label { display: block; margin-bottom: 8px; font-weight: bold; color: #333; }
        input, select { padding: 12px; width: 100%; border: 2px solid #ddd; border-radius: 5px; font-size: 16px; }
        input:focus, select:focus { border-color: #007bff; outline: none; }
        button { padding: 15px 30px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; width: 100%; margin: 20px 0; }
        button:hover { background: #0056b3; }
        button:disabled { background: #ccc; cursor: not-allowed; }
        .result { margin: 20px 0; padding: 20px; border-radius: 5px; }
        .success { background: #d4edda; border: 1px solid #c3e6cb; color: #155724; }
        .error { background: #f8d7da; border: 1px solid #f5c6cb; color: #721c24; }
        .prediction { background: #e7f3ff; border: 2px solid #007bff; margin: 10px 0; padding: 15px; border-radius: 8px; }
        .prediction h4 { margin: 0 0 10px 0; color: #007bff; }
        .loading { text-align: center; color: #666; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîÆ Simple Prediction Test</h1>
        <p>This is a simplified version to test the prediction system directly.</p>
        
        <div class="form-group">
            <label for="crypto">Cryptocurrency:</label>
            <select id="crypto">
                <option value="BTC">Bitcoin (BTC)</option>
                <option value="ETH">Ethereum (ETH)</option>
                <option value="ADA">Cardano (ADA)</option>
                <option value="BNB">Binance Coin (BNB)</option>
            </select>
        </div>
        
        <div class="form-group">
            <label for="days">Days Ahead (0-30):</label>
            <input type="number" id="days" value="1" min="0" max="30">
        </div>
        
        <div class="form-group">
            <label for="hours">Hours Ahead (0-23):</label>
            <input type="number" id="hours" value="2" min="0" max="23">
        </div>
        
        <button id="test-btn" onclick="testPrediction()">üöÄ Test Prediction</button>
        
        <div id="result"></div>
    </div>

    <script>
        async function testPrediction() {
            const resultDiv = document.getElementById('result');
            const testBtn = document.getElementById('test-btn');
            
            // Get values
            const crypto = document.getElementById('crypto').value;
            const days = parseInt(document.getElementById('days').value) || 0;
            const hours = parseInt(document.getElementById('hours').value) || 0;
            
            console.log('Testing with:', { crypto, days, hours });
            
            // Validate
            if (days === 0 && hours === 0) {
                resultDiv.innerHTML = '<div class="result error">Please select at least one prediction timeframe!</div>';
                return;
            }
            
            // Show loading
            testBtn.textContent = '‚è≥ Testing...';
            testBtn.disabled = true;
            resultDiv.innerHTML = '<div class="result loading">üîÑ Making API call...</div>';
            
            try {
                // Make API call
                const response = await fetch(`/api/predict/${crypto.toLowerCase()}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        symbol: crypto,
                        days_ahead: days,
                        hours_ahead: hours
                    })
                });
                
                console.log('Response status:', response.status);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                console.log('Response data:', data);
                
                // Display results
                let html = '<div class="result success">';
                html += `<h3>‚úÖ Prediction Results for ${data.symbol}</h3>`;
                
                if (data.current_price) {
                    html += `<p><strong>Current Price:</strong> $${data.current_price.toLocaleString()}</p>`;
                }
                
                if (data.daily_prediction) {
                    html += `<div class="prediction">
                        <h4>üìÖ Daily Prediction (INR)</h4>
                        <p><strong>Predicted Price:</strong> ‚Çπ${data.daily_prediction.predicted_price.toLocaleString()}</p>
                        <p><strong>Days Ahead:</strong> ${data.daily_prediction.days_ahead}</p>
                        <p><strong>Model:</strong> ${data.daily_prediction.model_type}</p>
                    </div>`;
                }
                
                if (data.hourly_prediction) {
                    html += `<div class="prediction">
                        <h4>‚è∞ Hourly Prediction (USDT)</h4>
                        <p><strong>Predicted Price:</strong> $${data.hourly_prediction.predicted_price.toLocaleString()}</p>
                        <p><strong>Hours Ahead:</strong> ${data.hourly_prediction.hours_ahead}</p>
                        <p><strong>Model:</strong> ${data.hourly_prediction.model_type}</p>
                    </div>`;
                }
                
                if (data.daily_error) {
                    html += `<p><strong>Daily Error:</strong> ${data.daily_error}</p>`;
                }
                
                if (data.hourly_error) {
                    html += `<p><strong>Hourly Error:</strong> ${data.hourly_error}</p>`;
                }
                
                html += '</div>';
                resultDiv.innerHTML = html;
                
            } catch (error) {
                console.error('Error:', error);
                resultDiv.innerHTML = `<div class="result error"><h3>‚ùå Error</h3><p>${error.message}</p></div>`;
            } finally {
                testBtn.textContent = 'üöÄ Test Prediction';
                testBtn.disabled = false;
            }
        }
        
        // Test on page load
        console.log('Simple test page loaded');
    </script>
</body>
</html>
